<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}}</title>
    {% load staticfiles %}
    <link rel="stylesheet" type="text/css" href="{% static 'dictionary/content/bootstrap.min.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'dictionary/content/site.css' %}" />
    <script src="{% static 'dictionary/scripts/modernizr-2.6.2.js' %}"></script>
    <script src="{% static 'dictionary/scripts/jquery-1.10.2.js' %}"></script>
    <script src="{% static 'dictionary/scripts/bootstrap.min.js' %}"></script>
    <script src="{% static 'dictionary/scripts/respond.js' %}"></script>
    <script src="{% static 'dictionary/scripts/diadict.js' %}"></script>

{% block extrajs %}

 
{% endblock %}

</head>

<body>
    {% include 'dictionary/topnav.html' %}

    {% block content %}
    <div class="container body-content">
      <div class="panel panel-default">
        <form name='trefwoordsearch' id='trefwoordsearch' action="" method='get' 
              onsubmit="return do_search('#id_submit_button', 'trefwoord', 'simple');" >
            <!-- EK: A sort-order specification is in a hidden form field, which is filled by JS:do_sort_column() -->
            <div class="hidden">
                <input name='sortOrder' class='form-control' value='woord' >
                <input name='search_type' class='form-control' value='woord'>
                <input id="submit_type" name="submit_type" class='form-control' value="simple">
            </div>

            {% include 'dictionary/dialectviewing.html' %}

            <!-- The top layer of searching -->
            <div class="row"><table><tr><td>&nbsp;</td></tr></table></div>


            <div id="searchdefault" class="row">
              <div class="col-sm-4">
                <div><label>&nbsp;</label></div>
                <div class='input-group'>
                  <label class='input-group-addon' 
                         data-toggle="popover" data-trigger="hover"
                         data-placement="right" data-content="Willekeurige tekens: ? (één) * (0 of meer). Groep tekens: [m-n]"
                         for='id_entry'>{{searchform.search.label}}</label>
                  <input name='search' class='form-control' {% if searchform.search.value %}value='{{searchform.search.value}}'{% endif %}>
                </div>
              </div>
              <div class="col-sm-4 col-sm-offset-2">
                <div><label>&nbsp;</label></div>
                <div class='btn-group'>
                    <!-- Make sure no button has the *name* 'submit', otherwise submit() cannot be used -->
                    <input class='btn btn-primary' type="submit" onclick="do_search(this, 'trefwoord', 'simple');" value="Zoek">
                    <input class='btn btn-default' type="submit" onclick="do_search(this, 'trefwoord', 'Herstel');" value="Herstel">
                    <!-- <input class='btn btn-default' type="submit" onclick="do_search(this, 'trefwoord', 'Csv');" name="submit_type" value="Csv"> -->
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" 
                        aria-haspopup="true" aria-expanded="false">Download <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                      <li><a href="#" onclick="do_search(this, 'trefwoord', 'Csv');" >Tab gescheiden lijst</a></li>
                      <li><a href="#" onclick="do_search(this, 'trefwoord', 'Excel');" >Excel</a></li>
                      <li><a href="#" onclick="do_search(this, 'trefwoord', 'Html');" >Html</a></li>
                    </ul>
                </div>
              </div>
              <div class="col-sm-2">
                <div class='form-group' id='paginate_by'>
                  <label for='paginate_by'>Per pagina</label>
                  <select class='form-control' name="paginate_by">
                    {% for pag in paginateValues %}
                    <option {% if pag == paginateSize %} selected {% endif %}>{{pag}}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
            </div>

            <!-- Collapsable area for fine-tuning -->
            <div class="row"><table><tr><td>&nbsp;</td></tr></table></div>
            <div class="panel panel-default">

              <div class="panel-heading" data-toggle="collapse" data-target="#query-area">Filteren...</div>

              <!-- class="collapse" -->
              <div id="query-area" class="collapse {% if not request.GET.search %} inert {% endif %}">


                <div id='searchformwell' class='well search-results-collapsable'>

                    <table class='table'>
                        <tr>
                          <td>
                            <div class='input-group'>
                              <label class='input-group-addon' 
                                      data-toggle="popover" data-trigger="hover"
                                      data-placement="right" data-content="Willekeurige tekens: ? (één) * (0 of meer). Groep tekens: [m-n]"
                                      for='id_lemma'>{{searchform.lemma.label}}</label>
                              <input name='lemma' class='form-control' {% if searchform.lemma.value %}value='{{searchform.lemma.value}}'{% endif %}>
                            </div>
                            <div><label>&nbsp;</label></div>
                            <div class='input-group'>
                              <label class='input-group-addon' 
                                      data-toggle="popover" data-trigger="hover"
                                      data-placement="right" data-content="Willekeurige tekens: ? (één) * (0 of meer). Groep tekens: [m-n]"
                                      for='id_dialectwoord'>{{searchform.dialectwoord.label}}</label>
                              <input name='dialectwoord' class='form-control' {% if searchform.dialectwoord.value %}value='{{searchform.dialectwoord.value}}'{% endif %}>
                            </div>
                            <div><label>&nbsp;</label></div>
                            <div class='input-group'>
                              <label class='input-group-addon' for='id_toelichting'>{{searchform.toelichting.label}}</label>
                              <input name='toelichting' class='form-control' {% if searchform.toelichting.value %}value='{{searchform.toelichting.value}}'{% endif %}>
                            </div>
                            <div><label>&nbsp;</label></div>
                            <div class="input-group">
                              <label class='input-group-addon' for='strict'>{{searchform.strict.label}}</label>
                              <select class="form-control" name="strict">
                                  <option value="False" {% if strict == 'False' %} selected {% endif %}>Nee</option>
                                  <option value="True" {% if strict == 'True' %} selected {% endif %}>Ja</option>
                              </select>
                            </div>
                          </td>
                          <td>
                            <div class='input-group'>
                              <label class='input-group-addon' for='id_city'>{{searchform.dialectCity.label}}</label>
                              <input name='dialectCity' class='form-control' {% if searchform.dialectCity.value %}value='{{searchform.dialectCity.value}}'{% endif %}>
                            </div>
                            <div><label>&nbsp;</label></div>
                            <div class='input-group'>
                              <label class='input-group-addon' for='id_code'>{{searchform.dialectCode.label}}</label>
                              <input name='dialectCode' class='form-control' {% if searchform.dialectCode.value %}value='{{searchform.dialectCode.value}}'{% endif %}>
                            </div>
                            <div><label>&nbsp;</label></div>
                            <div class='input-group'>
                              <label class='input-group-addon' for='aflevering'>{{searchform.aflevering.label}}</label>
                              <select class='form-control' name="aflevering">
                                  <option value="0">-</option>
                                {% for opt in afleveringen %}
                                  <option  {% if opt.id == aflkeuze %} selected {% endif %} value="{{opt.id}}">{{opt.get_summary}}</option>
                                {% endfor %}
                              </select>
                            </div>
                            <div><label>&nbsp;</label></div>
                            <div class='input-group'>
                              <label class='input-group-addon' for='mijn'>{{searchform.mijn.label}}</label>
                              <select class='form-control' name="mijn">
                                  <option value="0">-</option>
                                {% for opt in mijnen %}
                                  <option  {% if opt.id == mijnkeuze %} selected {% endif %} value="{{opt.id}}">{{opt.naam}}</option>
                                {% endfor %}
                              </select>
                            </div>

                          </td>
                        </tr>

                    </table>





              </div>
            </div>
            </div>
        </form>
      </div>

    {% if object_list %}
      <h3>Overzicht</h3>
      <div class="row">
          <div class="col-sm-4"><span>Gevonden: </span><span>{{entrycount}}</span></div>
          <div class="col-sm-8">
          <span class="step-links">

          {% include 'dictionary/pagination.html' %}

          </span>
          </div>
      </div>
      <table class="table table-hover">
        <thead><tr><th class="hidden">id</th><th>Trefwoord</th><th>Begrip: dialectopgave (plaats)</th><th>Toelichting</th></tr></thead>
        <tbody>
        {% if strict == 'True' %}
          {% for item in qlist %}
            {% if item.trefwoord_woord.first %}
              <tr class="dict-entry">
                <td class="hidden"> {{ item.entry.lemma.id }}</td>
                <td><span class="trefwoord-name">{{item.entry.trefwoord.woord}}</span></td>
                <td>
            {% endif %}
            {% if item.lemma_gloss.first  %}
              <!-- Start lemma -->
              <span class="lemma-name"><a href="{% url 'lemmasearch' %}?search={{item.entry.lemma.gloss|urlencode}}">{{item.entry.lemma.gloss}}</a>:</span>
            {% endif %}
            {% spaceless %}
              {% if item.dialectopgave.first  %}
                <span class="lemma-word">{{item.entry.dialectopgave}}</span>
                <span> (</span>
              {% endif %}
              {% if item.entry.toelichting != "" %}<span class="lemma-word-toelichting">{{item.entry.toelichting}} </span>{% endif %}
              {% if item.entry.dialect.nieuw != "Q000" %}
              <span class="lemma-word-dialect">
                <span class="lemma-word-dialect-code hidden">{{item.entry.dialect.nieuw}}</span>
                <span class="lemma-word-dialect-space hidden">&nbsp;</span>
                <span class="lemma-word-dialect-stad">{{item.entry.dialect.stad}}</span>
                {% if not item.dialectopgave.last %}<span>, </span>{% endif %}
              </span>
              {% endif %}
              {% if item.entry.mijnlijst.count > 0 %}
                <span class="word-mijn">{% if  item.entry.dialect.nieuw != "Q000"  %}&nbsp;{% endif %}[</span>
                {% for mijn in item.entry.mijnlijst.all %}
                  <span class="word-mijn">{{mijn.naam}}</span>
                  <span class="word-mijn-letop">{% if not forloop.last %}, {% endif %}</span>
                {% endfor %}
                <span class="word-mijn">]</span>
              {% endif %}
              {% if item.dialectopgave.last %}
                <span>)</span>
              {% endif %}
              {% if item.dialectopgave.last and not item.trefwoord_woord.last %}<span>, </span>{% endif %}
            {% endspaceless %}
            {% if item.trefwoord_woord.last %}
                <!-- Treat the afleveringen for this trefwoord -->
                {% spaceless %}
                {% for item_afl in item.alist %}
                  {% if item_afl.afl.first %}
                    <span class="lemma-aflevering"><a href="/{{app_prefix}}static/dictionary/content/pdf/{{item_afl.entry.aflevering.get_pdf}}">{{item_afl.entry.aflevering.get_summary}}</a></span>
                  {% endif %}
                  {% if item_afl.afl.last and not forloop.last %}<span>, </span>{% endif %}
                {% endfor %}
                {% endspaceless %}
                </td>
                <td>
                  <span class="toelichting">{{item.trefwoord.toelichting}}</span>
                </td>
              </tr>
            {% endif %}
          {% endfor %}
        {% else %}
          {% for tw in object_list %}
            <tr class="dict-entry">
              <td class="hidden"> {{ lem.id }} </td>
              <td>
                <span class="trefwoord-name">{{tw.woord}}</span>
              </td>
              <td>
                <!-- See: https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#regroup -->
                {% regroup tw.entry_set.all|dictsort:"get_lemma_gloss" by lemma as lemma_list %}
                {% for lem in lemma_list %}
                  <span class="lemma-name"><a href="{% url 'lemmasearch' %}?search={{lem.grouper|urlencode}}">{{lem.grouper}}</a>:</span>
                  {% regroup lem.list|dictsort:"get_lemma_gloss" by dialectopgave as word_list %}
                  {% for wrd in word_list %}    
                      <span class="lemma-word">{{wrd.grouper}}</span>
                      {% spaceless %}
                      <span>(</span>
                      {% for entry in wrd.list %}
                        {% if entry.toelichting != "" %}<span class="lemma-word-toelichting">{{entry.toelichting}} </span>{% endif %}
                        {% if entry.dialect.nieuw != "Q000" %}
                        <span class="lemma-word-dialect">
                          <span class="lemma-word-dialect-code hidden">{{entry.dialect.nieuw}}</span>
                          <span class="lemma-word-dialect-space hidden">&nbsp;</span>
                          <span class="lemma-word-dialect-stad">{{entry.dialect.stad}}</span>
                          <span>{% if not forloop.last %}, {% endif %}</span>
                        </span>
                        {% endif %}
                        {% if entry.mijnlijst.count > 0 %}
                          <span class="word-mijn">{% if  entry.dialect.nieuw != "Q000"  %}&nbsp;{% endif %}[</span>
                          {% for mijn in entry.mijnlijst.all %}
                            <span class="word-mijn">{{mijn.naam}}</span>
                            <span class="word-mijn-letop">{% if not forloop.last %}, {% endif %}</span>
                          {% endfor %}
                          <span class="word-mijn">]</span>
                          <span>{% if not forloop.last %}, {% endif %}</span>
                        {% endif %}
                      {% endfor %}
                      <span>){% if not forloop.last %}, {% endif %}</span>
                      {% endspaceless %}
                  {% endfor %}
                {% endfor %}
                {% regroup tw.entry_set.all|dictsort:"get_aflevering" by aflevering as afl_list  %}
                {% for afl in afl_list %}
                  <span class="lemma-aflevering"><a href="/{{app_prefix}}static/dictionary/content/pdf/{{afl.grouper.get_pdf}}">{{afl.grouper.get_summary}}</a></span>
                {% endfor %}
              </td>
              <td>
                <span class="toelichting">{{tw.toelichting}}</span>
              </td>
            </tr>
          {% endfor %}
        {% endif %}
        </tbody>
      </table>
    {% else %}
      <p>No keywords are available.</p>
    {% endif %}

      <div class="pagination">
          <span class="step-links">

          {% include 'dictionary/pagination.html' %}
          </span>
      </div>
    </div>


{% endblock content %}

{% block scripts %}{% endblock %}


</body>
</html>